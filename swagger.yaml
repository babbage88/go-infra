consumes:
    - application/json
produces:
    - application/json
schemes:
    - http
    - https
swagger: "2.0"
info:
    contact:
        email: test@trahan.dev
        name: Justin Trahan
    license:
        name: N/A
    termsOfService: there are no TOS at this moment, use at your own risk we take no responsibility
    title: go-infra API.
    version: v1.1.0
host: localhost:8993
paths:
    /create/permission:
        post:
            operationId: CreateAppPermission
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/CreateAppPermissionRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/CreateAppPermissionResponse'
            security:
                - bearer: []
            summary: Create New App Permission.
            tags:
                - PermissionsCRUD
    /create/role:
        post:
            operationId: CreateUserRole
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/CreateUserRoleRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/CreateUserRoleResponse'
            security:
                - bearer: []
            summary: Create New User Role.
            tags:
                - RolesCRUD
    /create/user:
        post:
            operationId: CreateUser
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/CreateNewUserRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/CreateUserResponse'
            security:
                - bearer: []
            summary: Create a new user.
            tags:
                - UserCRUD
    /login:
        post:
            operationId: LocalLogin
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/UserLoginRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/AuthToken'
            summary: Login a user and return token.
            tags:
                - Authentication
    /permissions:
        get:
            description: Returns all App Permissions
            operationId: GetAllAppPermissions
            responses:
                "200":
                    $ref: '#/responses/GetAllAppPermissionsResponse'
            security:
                - bearer: []
            tags:
                - PermissionsCRUD
    /renew:
        post:
            description: Request/Renew ssl certificate via cloudflare letsencrypt. Uses DNS Challenge
            operationId: Renew
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/CertDnsRenewReq'
                  x-go-name: Body
            produces:
                - application/json
                - application/zip
            responses:
                "200":
                    $ref: '#/responses/CertificateData'
            tags:
                - Certificates
    /roles:
        get:
            operationId: GetAllUserRoles
            responses:
                "200":
                    $ref: '#/responses/GetAllRolesResponse'
            security:
                - bearer: []
            summary: Returns all active User Roles.
            tags:
                - RolesCRUD
    /roles/permission:
        post:
            operationId: CreateRolePermissionMapping
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/CreateRolePermissionMappingRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/CreateRolePermissionMapptingResponse'
            security:
                - bearer: []
            summary: Map App Permission to User Role.
            tags:
                - PermissionsCRUD
    /secrets/create/{ID}:
        post:
            operationId: createUserSecret
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/CreateSecretRequest'
                  x-go-name: Body
            responses:
                "200":
                    description: Secret stored successfully
                "400":
                    description: Invalid request
                "401":
                    description: Unauthorized
            summary: Create a new external application secret.
            tags:
                - secrets
    /secrets/delete/{ID}:
        delete:
            operationId: deleteUserSecretByID
            parameters:
                - in: path
                  name: ID
                  required: true
                  type: string
            responses:
                "200":
                    description: Secret deleted successfully
                "401":
                    description: Unauthorized
                "403":
                    description: Forbidden
                "404":
                    description: Not Found
            summary: Delete a user secret by ID.
            tags:
                - secrets
    /secrets/{ID}:
        get:
            operationId: getUserSecretByID
            parameters:
                - description: ID of secret
                  in: path
                  name: ID
                  required: true
                  type: string
            responses:
                "200":
                    $ref: '#/responses/RetrievedSecretResponse'
                "401":
                    description: Unauthorized
                "403":
                    description: Forbidden
                "404":
                    description: Not Found
            summary: Retrieve a user secret by ID.
            tags:
                - secrets
    /token/refresh:
        post:
            operationId: RefreshAccessToken
            responses:
                "200":
                    $ref: '#/responses/AuthToken'
            summary: Refresh accessTokens andreturn to client.
            tags:
                - Authentication
    /update/userpass:
        post:
            operationId: UpdateUserPw
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/UpdateUserPasswordRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/UserPasswordUpdateResponse'
            security:
                - bearer: []
            summary: Update user password.
            tags:
                - UserCRUD
    /user/delete:
        delete:
            operationId: SoftDeleteUserById
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/SoftDeleteUserByIdRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/SoftDeleteUserByIdResponse'
            security:
                - bearer: []
            summary: Soft Delete User by id.
            tags:
                - UserCRUD
    /user/disable:
        post:
            operationId: DisableUser
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/DisableUserRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/UpdateUserRoleResponse'
            security:
                - bearer: []
            summary: Disable specified target User Id.
            tags:
                - UserCRUD
    /user/enable:
        post:
            operationId: EnableUser
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/EnableUserRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/EnableDisableUserResponse'
            security:
                - bearer: []
            summary: Enable specified target User Id.
            tags:
                - UserCRUD
    /user/role:
        post:
            description: Update User Role Mapping
            operationId: UpdateUserRole
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/UpdateUserRoleMappingRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/UpdateUserRoleMappingResponse'
            security:
                - bearer: []
            tags:
                - RolesCRUD
    /user/role/remove:
        post:
            description: Disable User Role Mapping
            operationId: DisableUserRoleMapping
            parameters:
                - in: body
                  name: body
                  schema:
                    $ref: '#/definitions/UpdateUserRoleMappingRequest'
                  x-go-name: Body
            responses:
                "200":
                    $ref: '#/responses/EnableDisableUserResponse'
            security:
                - bearer: []
            tags:
                - UserCRUD
    /users:
        get:
            operationId: GetAllUsers
            responses:
                "200":
                    $ref: '#/responses/GetAllUsersResponse'
            security:
                - bearer: []
            summary: Returns all active users.
            tags:
                - users
    /users/{ID}:
        get:
            operationId: getUserById
            parameters:
                - description: ID of user
                  in: path
                  name: ID
                  required: true
                  type: string
            responses:
                "200":
                    $ref: '#/responses/GetUserByIdResponse'
            security:
                - bearer: []
            summary: Returns User Info for the user id specified in URL users.
            tags:
                - users
definitions:
    AppPermissionDao:
        properties:
            id:
                format: uuid
                type: string
                x-go-name: Id
            permissionDescription:
                type: string
                x-go-name: PermissionDescription
            permissionName:
                type: string
                x-go-name: PermissionName
        type: object
        x-go-name: CreateAppPermissionResponse
        x-go-package: github.com/babbage88/go-infra/services/user_crud_svc
    AuthTokenDao:
        properties:
            created_at:
                format: date-time
                type: string
                x-go-name: CreatedAt
            expiration:
                format: date-time
                type: string
                x-go-name: Expiration
            id:
                format: uuid
                type: string
                x-go-name: Id
            last_modified:
                format: date-time
                type: string
                x-go-name: LastModified
            token:
                type: string
                x-go-name: Token
            user_id:
                format: uuid
                type: string
                x-go-name: UserID
        type: object
        x-go-package: github.com/babbage88/go-infra/services/user_crud_svc
    CertDnsRenewReq:
        properties:
            acmeEmail:
                type: string
                x-go-name: AcmeEmail
            acmeUrl:
                type: string
                x-go-name: AcmeUrl
            domainName:
                items:
                    type: string
                type: array
                x-go-name: DomainNames
            pushS3:
                type: boolean
                x-go-name: PushS3
            recurseServers:
                items:
                    type: string
                type: array
                x-go-name: RecursiveNameServers
            timeout:
                $ref: '#/definitions/Duration'
            token:
                type: string
                x-go-name: Token
            zipDir:
                type: string
                x-go-name: ZipDir
        type: object
        x-go-package: github.com/babbage88/go-infra/webutils/cert_renew
    CreateAppPermissionRequest:
        properties:
            descripiton:
                type: string
                x-go-name: PermissionDescription
            name:
                type: string
                x-go-name: PermissionName
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    CreateNewUserRequest:
        properties:
            newEmail:
                type: string
                x-go-name: NewUserEmail
            newPassword:
                type: string
                x-go-name: NewUserPassword
            newUsername:
                type: string
                x-go-name: NewUsername
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    CreateRolePermissionMappingRequest:
        properties:
            permId:
                format: uuid
                type: string
                x-go-name: PermissionId
            roleId:
                format: uuid
                type: string
                x-go-name: RoleId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    CreateSecretRequest:
        properties:
            application_id:
                format: uuid
                type: string
                x-go-name: ApplicationID
            expiration:
                format: date-time
                type: string
                x-go-name: Expiration
            secret:
                type: string
                x-go-name: Secret
        type: object
        x-go-package: github.com/babbage88/go-infra/services/user_secrets
    CreateUserRoleRequest:
        properties:
            roleDesc:
                type: string
                x-go-name: RoleDescription
            roleName:
                type: string
                x-go-name: RoleName
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    DisableUserRequest:
        properties:
            targetUserId:
                format: uuid
                type: string
                x-go-name: TargetUserId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    Duration:
        description: |-
            A Duration represents the elapsed time between two instants
            as an int64 nanosecond count. The representation limits the
            largest representable duration to approximately 290 years.
        format: int64
        type: integer
        x-go-package: time
    EnableDisableUserResponse:
        properties:
            error:
                type: string
                x-go-name: Error
            modifiedUserInfo:
                $ref: '#/definitions/UserDao'
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    EnableUserRequest:
        properties:
            targetUserId:
                format: uuid
                type: string
                x-go-name: TargetUserId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    HostServer:
        properties:
            CreatedAt:
                format: date-time
                type: string
            HostedDomains:
                items:
                    type: string
                type: array
            Hostname:
                type: string
            ID:
                format: int32
                type: integer
            IDDbHost:
                type: boolean
            IpAddress:
                type: string
            IsContainerHost:
                type: boolean
            IsVirtualMachine:
                type: boolean
            IsVmHost:
                type: boolean
            LastModified:
                format: date-time
                type: string
            PublicSshKeyname:
                type: string
            SslKeyPath:
                type: string
            Username:
                type: string
        type: object
        x-go-package: github.com/babbage88/go-infra/services/user_crud_svc
    HostedDbPlatform:
        properties:
            DefaultListenPort:
                format: int32
                type: integer
            ID:
                format: int32
                type: integer
            PlatformName:
                type: string
        type: object
        x-go-package: github.com/babbage88/go-infra/services/user_crud_svc
    RolePermissionMappingDao:
        properties:
            error:
                type: string
                x-go-name: Error
            newMappingInfo:
                $ref: '#/definitions/RolePermissionMappingDao'
        type: object
        x-go-name: CreateRolePermissionMappingResponse
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    SoftDeleteUserByIdRequest:
        properties:
            targetUserId:
                format: uuid
                type: string
                x-go-name: TargetUserId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    SoftDeleteUserByIdResponse:
        properties:
            deletedUserInfo:
                $ref: '#/definitions/UserDao'
            error:
                type: string
                x-go-name: Error
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    UUIDs:
        items:
            format: uuid
            type: string
        title: UUIDs is a slice of UUID types.
        type: array
        x-go-package: github.com/google/uuid
    UpdateUserPasswordRequest:
        properties:
            newPassword:
                type: string
                x-go-name: NewPassword
            targetUserId:
                format: uuid
                type: string
                x-go-name: TargetUserId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    UpdateUserRoleMappingRequest:
        properties:
            roleId:
                format: uuid
                type: string
                x-go-name: RoleId
            targetUserId:
                format: uuid
                type: string
                x-go-name: TargetUserId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    UpdateUserRoleMappingResponse:
        properties:
            error:
                type: string
                x-go-name: Error
            success:
                type: boolean
                x-go-name: Success
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    UserDao:
        properties:
            createdAt:
                format: date-time
                type: string
                x-go-name: CreatedAt
            email:
                type: string
                x-go-name: Email
            enabled:
                type: boolean
                x-go-name: Enabled
            id:
                format: uuid
                type: string
                x-go-name: Id
            isDeleted:
                type: boolean
                x-go-name: IsDeleted
            lastModified:
                format: date-time
                type: string
                x-go-name: LastModified
            role_ids:
                $ref: '#/definitions/UUIDs'
            roles:
                items:
                    type: string
                type: array
                x-go-name: Roles
            username:
                type: string
                x-go-name: UserName
        title: Respose will return login result and the user info.
        type: object
        x-go-package: github.com/babbage88/go-infra/services/user_crud_svc
    UserHostedDb:
        properties:
            CreatedAt:
                format: date-time
                type: string
            CurrentHostServerID:
                format: int32
                type: integer
            CurrentKubeClusterID:
                format: int32
                type: integer
            DbPlatformID:
                format: int32
                type: integer
            Fqdn:
                type: string
            ID:
                format: int32
                type: integer
            LastModified:
                format: date-time
                type: string
            ListenPort:
                format: int32
                type: integer
            PriceTierCodeID:
                format: int32
                type: integer
            PrivateIpAddress:
                type: string
            PubIpAddress:
                type: string
            UserApplicationIds:
                items:
                    format: int32
                    type: integer
                type: array
            UserID:
                format: int32
                type: integer
        type: object
        x-go-package: github.com/babbage88/go-infra/services/user_crud_svc
    UserLoginRequest:
        properties:
            password:
                type: string
                x-go-name: Password
            username:
                type: string
                x-go-name: UserName
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/authapi
    UserPasswordUpdateResponse:
        properties:
            error:
                type: string
                x-go-name: Error
            success:
                type: boolean
                x-go-name: Success
            targetUserId:
                format: uuid
                type: string
                x-go-name: TargetUserId
        type: object
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
    UserRoleDao:
        properties:
            error:
                type: string
                x-go-name: Error
            newUserRoleInfo:
                $ref: '#/definitions/UserRoleDao'
        type: object
        x-go-name: CreateUserRoleResponse
        x-go-package: github.com/babbage88/go-infra/webapi/user_api_handlers
responses:
    AuthToken:
        description: Respose will return login result and the user info.
        headers:
            expiration:
                format: date-time
                type: string
            refreshToken:
                type: string
            token:
                type: string
    CertificateData:
        description: (empty)
        headers:
            cert_pem:
                type: string
            chain_pem:
                type: string
            domainName:
                items:
                    type: string
                type: array
            fullchain_pem:
                type: string
            priv_key:
                type: string
            s3DownloadUrl:
                type: string
            zipDir:
                type: string
    CreateAppPermissionResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/AppPermissionDao'
    CreateRolePermissionMappingResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/RolePermissionMappingDao'
    CreateUserResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/UserDao'
    CreateUserRoleResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/UserRoleDao'
    EnableDisableUserResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/EnableDisableUserResponse'
    GetAllRolesResponse:
        description: (empty)
        headers:
            userRoles:
                items:
                    $ref: '#/definitions/UserRoleDao'
                type: array
    GetAllUsersResponse:
        description: (empty)
        headers:
            users:
                items:
                    $ref: '#/definitions/UserDao'
                type: array
    GetUserByIdResponse:
        description: (empty)
        headers:
            user: {}
        schema:
            $ref: '#/definitions/UserDao'
    RetrievedSecretResponse:
        description: (empty)
        schema:
            properties:
                expiration:
                    format: date-time
                    type: string
                    x-go-name: Expiration
                external_application_id:
                    format: uuid
                    type: string
                    x-go-name: ExternalApplication
                id:
                    format: uuid
                    type: string
                    x-go-name: ID
                token:
                    type: string
                    x-go-name: Token
                user_id:
                    format: uuid
                    type: string
                    x-go-name: UserID
            type: object
    SoftDeleteUserByIdResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/SoftDeleteUserByIdResponse'
    UpdateUserRoleMappingResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/UpdateUserRoleMappingResponse'
    UserPasswordUpdateResponse:
        description: (empty)
        schema:
            $ref: '#/definitions/UserPasswordUpdateResponse'
securityDefinitions:
    bearer:
        in: header
        name: Authorization
        type: apiKey
security:
    - bearer: []
